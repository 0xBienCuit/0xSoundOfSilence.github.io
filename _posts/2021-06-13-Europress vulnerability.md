---
Author: 0xSoundOfSilence
Date: "2023-06-13"
created: "2021-06-13"
Title: Securing Industrial Machine Monitoring Applications
subject: Exposed confidential user credentials hidden in source code
layout: post
---

> EUROPRESS is specialized in manufacturing highly advanced cardboard recycles machines. Manufactured straight from Switzerland.

# Summary

I was given a sample by the CEO, which was a .msi installer. Upon installing it, we got an executable we could execute with a prompt asking us to provide a master password.

In this advisory, we will discuss the vulnerability found in the application, the impact of the vulnerability, and the recommended fix for the vulnerability.

Hypothetical scenarios exploiting this vulnerability include:

- Unauthorized Control: Exploiting the plain-text credentials, a threat actor remotely manipulates the industrial machines, causing production disruptions and potential damage.

- Data Manipulation: Malicious actors alter application data, such as production records and inventory levels, leading to incorrect decision-making, financial losses, or compromised product quality.
- Sabotage and Espionage: Unauthorized access allows competitors or insiders to sabotage operations, cause accidents, or gather sensitive business information for industrial espionage.
- Impersonation and Unauthorized Actions: Threat actors compromise user accounts to impersonate authorized personnel and perform actions beyond their privileges, compromising safety protocols and product integrity.
- Ransom or Extortion: By gaining control over the machines, attackers extort the company by threatening to disrupt production or cause damage unless a ransom is paid.

The vulnerabilities and PoC's demonstrated in this advisory have already been patched by the vendor. The patch has been issued by the vendor and have mitigated this vulnerability with the release of their latest version.

## Not your typical vulnerability assessment

Let me explain: my best friend's father-in-law runs his own company where he produces sophisticated industrial machines used to compress cardboard.

You might wonder... hasn't this already been done... well my truest answer is yes. Nevertheless, to say he saw an opportunity to have all these industrialised machines be monitored via a web console. The CEO in question did outsource the development of the development of the application which suits his needs and can integrate into his ongoing business processes. Without causing much disturbance

## Technical Details

### Code Analysis

Upon investigating the `Program.cs` file, we quickly see credentials put into the code in plain text:

![](https://i.imgur.com/bS25PGh.png)

It not only embedded plain-text credentials into the code, also the level of access each user has was discovered. This is something we researchers frown upon. You should never store your user's confidential data albeit in a DB or straight up in the source code in plain-text!

### Proof of Concept

We were successfully able to log in to the administrator dashboard with the found credentials. Here are some examples of us gaining access to the dashboard, which gave us the ability to change values and valves at our will.

![](https://i.imgur.com/1DNcwWV.png)

![](https://i.imgur.com/fu3jCBP.png)

In total, we compromised 18 accounts by doing some static analysis on the source code.

## Recommended Fix for the Vulnerability Finding

1. Remove plain-text credentials from the source code.
2. Implement secure authentication and authorization methods.
3. Apply role-based access control (RBAC) to ensure appropriate user privileges.
4. Conduct a thorough code review for other potential security issues.
5. Secure the application deployment on a hardened web server.
6. Regularly update and maintain the application and its dependencies.
7. Perform regular security testing, including penetration testing and code reviews.
8. Educate developers on secure coding practices.

Implementing these fixes will enhance the application's security by eliminating plain-text credentials, strengthening authentication and access control, and addressing other potential vulnerabilities. Regular updates, security testing, and developer education are crucial for maintaining a secure application environment.

## Final Thoughts

In conclusion, the discovered vulnerability in the industrial machine monitoring application highlights the importance of prioritizing security in software development. Storing plain-text credentials in the source code and lacking proper authentication and access control mechanisms poses a significant risk to the confidentiality and integrity of user data.

Fortunately, by implementing the recommended fixes outlined above, the application's security can be significantly enhanced. Removing plain-text credentials, implementing secure authentication methods, and applying role-based access control will mitigate the identified vulnerability and prevent unauthorized access.

Furthermore, conducting a thorough code review, securing the application deployment, and regularly updating and maintaining the application are essential steps in ensuring ongoing security. Performing regular security testing, including penetration testing and code reviews, will help identify and address any new vulnerabilities that may arise.

It is vital to foster a culture of security awareness among developers and provide them with the necessary training and guidance on secure coding practices. By doing so, organizations can reduce the risk of security incidents and protect sensitive data from unauthorized access.

Remember, security is not a one-time effort but an ongoing commitment. Regular assessments, updates, and education are crucial to maintaining a strong security posture and safeguarding the application against evolving threats.

By taking these steps and prioritizing security throughout the software development lifecycle, companies can instill confidence in their customers, protect their reputation, and ensure the integrity of their systems and data.

---

references:

- [EUROPRESS](https://europressgroup.com/nl/)
- [Redacted source code](https://gist.github.com/NicoBouquiaux/d20d07875d79bf2cf634b7f0ba99df27)
